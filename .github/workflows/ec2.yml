name: AWS-EC2 Instance CD

on:
  workflow_run:
    workflows: ["Frontend CI with Docker"]
    types: [completed]

jobs:
  on-success:

    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    steps:
      - name: AWS SSM Send-Command
        uses: bitovi/github-actions-deploy-docker-to-ec2@v1.0.1
        with:
          aws_access_key_id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws_secret_access_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws_default_region: ${{ secrets.AWS_REGION }}
          instance_ids: ${{ secrets.AWS_INSTANCE_ID }}
          dot_env: ${{ secrets.DOT_ENV }}

          env_ghs: ${{ secrets.DOT_ENV }}
          env_ghv: ${{ vars.VARS }}